<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Apps Script - Learning Hub</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background-color: #f0f2f5;
      font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
    }

    .slide-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      padding: 20px;
      min-height: 100vh;
    }

    .slide-wrapper {
      background: white;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
      border-radius: 16px;
      overflow: hidden;
      width: 1400px;
      max-width: 100%;
    }

    .slide-wrapper > section {
      width: 1400px;
      min-height: 900px;
      position: relative;
      transform-origin: top left;
    }

    /* Responsive scaling */
    @media (max-width: 1480px) {
      .slide-wrapper {
        width: calc(100vw - 40px);
      }
      .slide-wrapper > section {
        transform: scale(calc((100vw - 40px) / 1400));
        height: calc(900px * ((100vw - 40px) / 1400));
      }
    }

    /* Header Styles - Optimizado */
    .main-header {
      height: 60px;
      background: linear-gradient(135deg, #1a73e8 0%, #4285F4 100%);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 25px;
      color: white;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: rgba(255,255,255,0.2);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 16px;
    }

    .header-level-badge {
      display: flex;
      align-items: center;
      gap: 6px;
      background: rgba(255,255,255,0.2);
      color: white;
      font-size: 12px;
      font-weight: 600;
      padding: 6px 14px;
      border-radius: 20px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .nav-section {
      display: flex;
      gap: 8px;
    }

    .nav-item {
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
      padding: 8px 14px;
      border-radius: 6px;
      transition: all 0.2s;
    }

    .nav-item:hover {
      background: rgba(255,255,255,0.15);
    }

    .nav-item.active {
      background: rgba(255,255,255,0.25);
    }

    .progress-section {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .progress-bar {
      width: 80px;
      height: 6px;
      background: rgba(255,255,255,0.3);
      border-radius: 3px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: #34A853;
      width: 60%;
      transition: width 0.3s;
    }

    /* Main Layout */
    .main-content {
      display: flex;
      min-height: calc(900px - 60px);
    }

    /* Sidebar */
    .sidebar {
      width: 200px;
      background: #f8f9fa;
      border-right: 1px solid #e8eaed;
      padding: 16px 0;
      overflow-y: auto;
    }

    .sidebar-title {
      font-size: 10px;
      font-weight: 700;
      color: #5f6368;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 0 14px 10px;
    }

    .sidebar-section {
      margin-bottom: 12px;
    }

    .sidebar-header {
      padding: 6px 14px;
      font-weight: 600;
      font-size: 12px;
      color: #3c4043;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .sidebar-link {
      display: block;
      padding: 5px 14px 5px 30px;
      color: #5f6368;
      text-decoration: none;
      font-size: 11px;
      transition: all 0.2s;
      border-left: 2px solid transparent;
    }

    .sidebar-link:hover {
      background: white;
      color: #1a73e8;
      border-left-color: #1a73e8;
    }

    /* Content Area */
    .content-area {
      flex: 1;
      display: flex;
      padding: 20px;
      gap: 20px;
      background: #f0f2f5;
    }

    .academic-panel {
      flex: 1.1;
      display: flex;
      flex-direction: column;
      gap: 16px;
      overflow-y: auto;
      max-height: 820px;
    }

    .code-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    /* Title Section with Dropdown and Navigation */
    .title-section {
      background: white;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .title-nav-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .nav-arrow {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid #dadce0;
      background: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      color: #5f6368;
      transition: all 0.2s;
      flex-shrink: 0;
    }

    .nav-arrow:hover {
      background: #f1f3f4;
      border-color: #1a73e8;
      color: #1a73e8;
    }

    .nav-arrow:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .title-dropdown-wrapper {
      position: relative;
      flex: 1;
    }

    .title-dropdown-btn {
      width: 100%;
      background: white;
      border: 2px solid #e8eaed;
      border-radius: 8px;
      padding: 10px 14px;
      font-size: 18px;
      font-weight: 700;
      color: #202124;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: all 0.2s;
    }

    .title-dropdown-btn:hover {
      border-color: #1a73e8;
    }

    .title-dropdown-btn .dropdown-arrow {
      font-size: 12px;
      color: #5f6368;
      transition: transform 0.2s;
    }

    .title-dropdown-btn.open .dropdown-arrow {
      transform: rotate(180deg);
    }

    .title-dropdown-menu {
      position: absolute;
      top: calc(100% + 6px);
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #e8eaed;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      max-height: 400px;
      overflow-y: auto;
      z-index: 100;
      display: none;
    }

    .title-dropdown-menu.open {
      display: block;
    }

    .dropdown-group {
      padding: 6px 0;
    }

    .dropdown-group-title {
      padding: 6px 14px;
      font-size: 10px;
      font-weight: 700;
      color: #5f6368;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .dropdown-item {
      padding: 8px 14px 8px 28px;
      font-size: 13px;
      color: #3c4043;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .dropdown-item:hover {
      background: #f1f3f4;
    }

    .dropdown-item.active {
      background: #e8f0fe;
      color: #1967d2;
      font-weight: 600;
    }

    .dropdown-item .check-icon {
      display: none;
    }

    .dropdown-item.active .check-icon {
      display: inline;
    }

    /* Info Cards */
    .info-card {
      background: white;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .info-card-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
      font-size: 15px;
      font-weight: 600;
      color: #202124;
    }

    .info-card-icon {
      width: 26px;
      height: 26px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
    }

    .icon-objectives { background: #e6f4ea; }
    .icon-concepts { background: #e8f0fe; }
    .icon-practices { background: #fef3e8; }
    .icon-resources { background: #fce8e8; }

    .info-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .practice-item {
      padding: 10px 0;
      border-bottom: 1px solid #f1f3f4;
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .practice-item:last-child {
      border-bottom: none;
    }

    .practice-content {
      flex: 1;
    }

    .practice-title {
      font-weight: 600;
      color: #202124;
      font-size: 13px;
      margin-bottom: 4px;
    }

    .practice-desc {
      color: #5f6368;
      font-size: 12px;
      line-height: 1.5;
    }

    .practice-btn {
      padding: 6px 12px;
      background: #fef3e8;
      border: 1px solid #f9ab00;
      border-radius: 6px;
      color: #b06000;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: all 0.2s;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .practice-btn:hover {
      background: #f9ab00;
      color: white;
    }

    .info-list li {
      padding: 8px 0;
      color: #5f6368;
      font-size: 13px;
      line-height: 1.6;
      border-bottom: 1px solid #f1f3f4;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .info-list li:last-child {
      border-bottom: none;
    }

    .info-list li::before {
      content: "‚Ä∫";
      color: #1a73e8;
      font-weight: bold;
      font-size: 16px;
      line-height: 1;
    }

    .info-list strong {
      color: #202124;
    }

    /* Video Placeholder */
    .video-container {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      border-radius: 12px;
      aspect-ratio: 16/9;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .video-overlay {
      position: absolute;
      inset: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect fill="%231a1a2e"/><circle cx="50" cy="50" r="30" fill="none" stroke="%234285F4" stroke-width="0.5" opacity="0.3"/></svg>');
      opacity: 0.5;
    }

    .play-button {
      width: 60px;
      height: 60px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(8px);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid rgba(255,255,255,0.5);
      cursor: pointer;
      transition: all 0.2s;
      z-index: 2;
    }

    .play-button:hover {
      background: rgba(255,255,255,0.25);
      transform: scale(1.05);
    }

    .play-button::after {
      content: "";
      width: 0;
      height: 0;
      border-top: 10px solid transparent;
      border-bottom: 10px solid transparent;
      border-left: 16px solid white;
      margin-left: 3px;
    }

    /* Resource Buttons */
    .resource-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .resource-btn {
      padding: 8px 14px;
      background: white;
      border: 1px solid #dadce0;
      border-radius: 8px;
      color: #1a73e8;
      font-weight: 500;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s;
    }

    .resource-btn:hover {
      background: #f1f3f4;
      border-color: #1a73e8;
    }

    /* Code Editor Section */
    .editor-container {
      background: #1e1e1e;
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }

    .editor-header {
      background: #2d2d2d;
      padding: 10px 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #3e3e3e;
    }

    .editor-tabs {
      display: flex;
      gap: 4px;
    }

    .editor-tab {
      padding: 5px 12px;
      background: #3e3e3e;
      color: #d4d4d4;
      font-size: 11px;
      border-radius: 4px 4px 0 0;
      cursor: pointer;
    }

    .editor-tab.active {
      background: #1e1e1e;
      color: white;
    }

    .editor-actions {
      display: flex;
      gap: 6px;
    }

    .editor-btn {
      padding: 5px 10px;
      background: #3e3e3e;
      border: none;
      border-radius: 4px;
      color: #d4d4d4;
      font-size: 11px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: all 0.2s;
    }

    .editor-btn:hover {
      background: #4e4e4e;
      color: white;
    }

    .editor-btn.primary {
      background: #4285F4;
      color: white;
    }

    .editor-btn.primary:hover {
      background: #3367d6;
    }

    .editor-body {
      display: flex;
      flex: 1;
      min-height: 260px;
    }

    .line-numbers {
      width: 40px;
      background: #252526;
      color: #858585;
      font-family: 'Fira Code', 'Consolas', monospace;
      font-size: 12px;
      padding: 14px 6px;
      text-align: right;
      line-height: 1.6;
      user-select: none;
    }

    .code-textarea {
      flex: 1;
      background: #1e1e1e;
      border: none;
      padding: 14px;
      font-family: 'Fira Code', 'Consolas', monospace;
      font-size: 12px;
      line-height: 1.6;
      color: #d4d4d4;
      resize: none;
      outline: none;
    }

    .code-textarea::placeholder {
      color: #6e6e6e;
    }

    /* Toolbar */
    .editor-toolbar {
      background: #252526;
      padding: 8px 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid #3e3e3e;
    }

    .toolbar-left {
      display: flex;
      gap: 8px;
    }

    .toolbar-btn {
      padding: 5px 10px;
      background: transparent;
      border: 1px solid #3e3e3e;
      border-radius: 4px;
      color: #d4d4d4;
      font-size: 11px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 4px;
      transition: all 0.2s;
    }

    .toolbar-btn:hover {
      background: #3e3e3e;
      border-color: #4e4e4e;
    }

    .toolbar-btn.danger:hover {
      background: #ef4444;
      border-color: #ef4444;
      color: white;
    }

    .toolbar-btn.success {
      background: #34A853;
      border-color: #34A853;
      color: white;
    }

    .toolbar-btn.success:hover {
      background: #2e9649;
    }

    .status-indicator {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: #858585;
    }

    .status-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #f59e0b;
    }

    .status-dot.ready {
      background: #34A853;
    }

    .status-dot.running {
      background: #f59e0b;
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Output Section */
    .output-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .output-tabs {
      display: flex;
      gap: 6px;
    }

    .output-tab {
      padding: 6px 14px;
      background: white;
      border: 1px solid #dadce0;
      border-radius: 8px 8px 0 0;
      font-size: 12px;
      font-weight: 500;
      color: #5f6368;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      border-bottom: none;
    }

    .output-tab.active {
      background: #1e1e1e;
      color: white;
      border-color: #1e1e1e;
    }

    .output-container {
      background: #1e1e1e;
      border-radius: 0 12px 12px 12px;
      min-height: 120px;
      max-height: 160px;
      overflow-y: auto;
      font-family: 'Fira Code', 'Consolas', monospace;
      font-size: 12px;
    }

    .output-content {
      padding: 14px;
      color: #d4d4d4;
      line-height: 1.6;
    }

    .output-line {
      margin-bottom: 4px;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .output-timestamp {
      color: #6a9955;
      font-size: 10px;
      flex-shrink: 0;
    }

    .output-label {
      font-size: 10px;
      font-weight: bold;
      text-transform: uppercase;
      flex-shrink: 0;
    }

    .output-label.info { color: #9cdcfe; }
    .output-label.success { color: #10b981; }
    .output-label.error { color: #ef4444; }
    .output-label.result { color: #ce9178; }

    .output-message {
      color: #d4d4d4;
    }

    .output-empty {
      color: #6e6e6e;
      font-style: italic;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: #dadce0;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #bdc1c6;
    }

    /* Print styles */
    @media print {
      body { background: white; }
      .slide-container { gap: 0; padding: 0; }
      .slide-wrapper { box-shadow: none; border-radius: 0; }
    }
  </style>
</head>
<body>
  <div class="slide-container">
    <div class="slide-wrapper">
      <section class="page">
        <!-- Header Optimizado -->
        <header class="main-header">
          <div class="logo-section">
            <div class="logo-icon">&lt;/&gt;</div>
            <div class="header-level-badge">‚óè Nivel Intermedio</div>
          </div>
          <nav class="nav-section">
            <span class="nav-item active">Lecciones</span>
            <span class="nav-item">Documentaci√≥n</span>
            <span class="nav-item">Comunidad</span>
            <span class="nav-item">Proyectos</span>
          </nav>
          <div class="progress-section">
            <span style="font-size: 12px;">60%</span>
            <div class="progress-bar">
              <div class="progress-fill"></div>
            </div>
          </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
          <!-- Sidebar -->
          <aside class="sidebar">
            <div class="sidebar-title">Recursos</div>
            
            <div class="sidebar-section">
              <div class="sidebar-header">üìπ Videos</div>
              <a href="#" class="sidebar-link">Introducci√≥n al IDE</a>
              <a href="#" class="sidebar-link">Debugging B√°sico</a>
              <a href="#" class="sidebar-link">Funciones Avanzadas</a>
            </div>

            <div class="sidebar-section">
              <div class="sidebar-header">üéôÔ∏è Audio</div>
              <a href="#" class="sidebar-link">Podcast: GAS vs VBA</a>
              <a href="#" class="sidebar-link">Entrevista DevRel</a>
            </div>

            <div class="sidebar-section">
              <div class="sidebar-header">üìö Bibliograf√≠a</div>
              <a href="#" class="sidebar-link">Clean Code JS</a>
              <a href="#" class="sidebar-link">Google Developer Guide</a>
              <a href="#" class="sidebar-link">ECMAScript Specs</a>
            </div>

            <div class="sidebar-section">
              <div class="sidebar-header">üìñ Documentaci√≥n</div>
              <a href="#" class="sidebar-link">Class SpreadsheetApp</a>
              <a href="#" class="sidebar-link">Quotas & Limits</a>
            </div>

            <div class="sidebar-section">
              <div class="sidebar-header">üîó Enlaces</div>
              <a href="#" class="sidebar-link">Stack Overflow [GAS]</a>
              <a href="#" class="sidebar-link">Reddit r/googleappsscript</a>
            </div>
          </aside>

          <!-- Content Area -->
          <div class="content-area">
            <!-- Academic Panel -->
            <div class="academic-panel">
              <!-- Title with Dropdown and Navigation -->
              <div class="title-section">
                <div class="title-nav-container">
                  <button class="nav-arrow" id="prevBtn" onclick="navigateLesson(-1)" title="Lecci√≥n anterior">‚Äπ</button>
                  
                  <div class="title-dropdown-wrapper">
                    <button class="title-dropdown-btn" id="titleDropdownBtn" onclick="toggleTitleDropdown()">
                      <span id="currentLessonTitle">Lecci√≥n 2.3: Dominando el IDE de Google Apps Script</span>
                      <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <div class="title-dropdown-menu" id="titleDropdownMenu">
                      <div class="dropdown-group">
                        <div class="dropdown-group-title">M√≥dulo 1: Fundamentos</div>
                        <div class="dropdown-item" data-lesson="1.1" onclick="selectLesson('1.1')">
                          Lecci√≥n 1.1: Introducci√≥n a GAS
                          <span class="check-icon">‚úì</span>
                        </div>
                        <div class="dropdown-item" data-lesson="1.2" onclick="selectLesson('1.2')">
                          Lecci√≥n 1.2: Variables y Funciones
                          <span class="check-icon">‚úì</span>
                        </div>
                      </div>
                      <div class="dropdown-group">
                        <div class="dropdown-group-title">M√≥dulo 2: Integraci√≥n con Sheets</div>
                        <div class="dropdown-item" data-lesson="2.1" onclick="selectLesson('2.1')">
                          Lecci√≥n 2.1: Primeros pasos con Sheets
                          <span class="check-icon">‚úì</span>
                        </div>
                        <div class="dropdown-item" data-lesson="2.2" onclick="selectLesson('2.2')">
                          Lecci√≥n 2.2: Manipulaci√≥n de Datos
                          <span class="check-icon">‚úì</span>
                        </div>
                        <div class="dropdown-item active" data-lesson="2.3" onclick="selectLesson('2.3')">
                          Lecci√≥n 2.3: Dominando el IDE
                          <span class="check-icon">‚úì</span>
                        </div>
                      </div>
                      <div class="dropdown-group">
                        <div class="dropdown-group-title">M√≥dulo 3: Automatizaci√≥n</div>
                        <div class="dropdown-item" data-lesson="3.1" onclick="selectLesson('3.1')">
                          Lecci√≥n 3.1: Triggers y Automatizaci√≥n
                          <span class="check-icon">‚úì</span>
                        </div>
                        <div class="dropdown-item" data-lesson="3.2" onclick="selectLesson('3.2')">
                          Lecci√≥n 3.2: Proyecto Final
                          <span class="check-icon">‚úì</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <button class="nav-arrow" id="nextBtn" onclick="navigateLesson(1)" title="Siguiente lecci√≥n">‚Ä∫</button>
                </div>
              </div>

              <!-- Objectives Card -->
              <div class="info-card">
                <div class="info-card-header">
                  <div class="info-card-icon icon-objectives">üéØ</div>
                  Objetivos de la Sesi√≥n
                </div>
                <ul class="info-list">
                  <li>Navegar funciones avanzadas del IDE de Google Apps Script</li>
                  <li>Manipular datos entre Google Sheets y otros servicios de Google</li>
                  <li>Implementar buenas pr√°cticas de rendimiento y optimizaci√≥n</li>
                  <li>Depurar c√≥digo profesionalmente usando breakpoints y logging</li>
                </ul>
              </div>

              <!-- Video -->
              <div class="video-container">
                <div class="video-overlay"></div>
                <div class="play-button"></div>
              </div>

              <!-- Concepts Card -->
              <div class="info-card">
                <div class="info-card-header">
                  <div class="info-card-icon icon-concepts">üìö</div>
                  Conceptos Clave
                </div>
                <ul class="info-list">
                  <li><strong>Jerarqu√≠a de Objetos:</strong> SpreadsheetApp ‚Üí Spreadsheet ‚Üí Sheet ‚Üí Range</li>
                  <li><strong>Arreglos (Arrays):</strong> Manejo eficiente de datos en 1D y 2D para operaciones masivas</li>
                  <li><strong>Lectura en Lote:</strong> Usar getDataRange() es significativamente m√°s r√°pido que leer celda por celda</li>
                  <li><strong>API de Servicios:</strong> Integraci√≥n con Gmail, Calendar, Drive y otros servicios Google</li>
                </ul>
              </div>

              <!-- Best Practices Card con Botones -->
              <div class="info-card">
                <div class="info-card-header">
                  <div class="info-card-icon icon-practices">üöÄ</div>
                  Buenas Pr√°cticas
                </div>
                <div class="info-list">
                  <div class="practice-item">
                    <div class="practice-content">
                      <div class="practice-title">Logging Moderno</div>
                      <div class="practice-desc">Usar console.log() (moderno) en lugar de Logger.log() (cl√°sico) para mejor rendimiento</div>
                    </div>
                    <button class="practice-btn" onclick="loadExample('logging')">‚ñ∂ Ver ejemplo</button>
                  </div>
                  <div class="practice-item">
                    <div class="practice-content">
                      <div class="practice-title">Depuraci√≥n con Breakpoints</div>
                      <div class="practice-desc">Utilizar Breakpoints para detener la ejecuci√≥n y inspeccionar variables en tiempo real</div>
                    </div>
                    <button class="practice-btn" onclick="loadExample('debugging')">‚ñ∂ Ver ejemplo</button>
                  </div>
                  <div class="practice-item">
                    <div class="practice-content">
                      <div class="practice-title">Manejo de Errores</div>
                      <div class="practice-desc">Implementar bloques try-catch para un manejo robusto de excepciones</div>
                    </div>
                    <button class="practice-btn" onclick="loadExample('errors')">‚ñ∂ Ver ejemplo</button>
                  </div>
                  <div class="practice-item">
                    <div class="practice-content">
                      <div class="practice-title">Optimizaci√≥n de Velocidad</div>
                      <div class="practice-desc">Preferir setValues() sobre setValue() en bucles para minimizar llamadas a la API</div>
                    </div>
                    <button class="practice-btn" onclick="loadExample('optimization')">‚ñ∂ Ver ejemplo</button>
                  </div>
                </div>
              </div>

              <!-- Resources -->
              <div class="info-card">
                <div class="info-card-header">
                  <div class="info-card-icon icon-resources">üîó</div>
                  Recursos Adicionales
                </div>
                <div class="resource-buttons">
                  <button class="resource-btn">üìÑ Documentaci√≥n Oficial</button>
                  <button class="resource-btn">üìÅ Hoja de C√°lculo Demo</button>
                  <button class="resource-btn">üíª C√≥digo de Ejemplo</button>
                </div>
              </div>
            </div>

            <!-- Code Panel -->
            <div class="code-panel">
              <!-- Code Editor -->
              <div class="editor-container" style="flex: 1;">
                <div class="editor-header">
                  <div class="editor-tabs">
                    <div class="editor-tab active">editor.gs</div>
                  </div>
                  <div class="editor-actions">
                    <button class="editor-btn" onclick="copyReferenceCode()" title="Copiar c√≥digo">
                      üìã Copiar
                    </button>
                  </div>
                </div>
                <div class="editor-body">
                  <div class="line-numbers" id="lineNumbers">1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23</div>
                  <textarea class="code-textarea" id="codeEditor" placeholder="// Escribe tu c√≥digo aqu√≠ o selecciona un ejemplo de 'Buenas Pr√°cticas'..." spellcheck="false">function enviarRecordatorios() {
  // 1. Obtener datos en lote (Eficiente)
  var sheet = SpreadsheetApp.getActiveSheet();
  var data = sheet.getDataRange().getValues();

  // 2. Iterar arreglo 2D (saltando encabezado)
  for (var i = 1; i < data.length; i++) {
    var fila = data[i];
    var email = fila[0];
    var estado = fila[2];

    try {
      if (estado !== "Enviado") {
        // MailApp.sendEmail(email, "Recordatorio", "...");
        console.log("Enviando correo a: " + email);

        // Actualizar estado en memoria
        data[i][2] = "Enviado";
      }
    } catch (e) {
      console.error("Error fila " + i + ": " + e);
    }
  }

  // 3. Escribir todo de vuelta (1 sola llamada)
  sheet.getRange(1, 1, data.length, data[0].length).setValues(data);
}</textarea>
                </div>
                <div class="editor-toolbar">
                  <div class="toolbar-left">
                    <button class="toolbar-btn danger" onclick="clearEditor()" title="Limpiar editor">
                      üóëÔ∏è Limpiar
                    </button>
                    <button class="toolbar-btn" onclick="restoreEditor()" title="Restaurar c√≥digo">
                      ‚Ü©Ô∏è Restaurar
                    </button>
                    <button class="toolbar-btn" onclick="downloadCode()" title="Descargar c√≥digo">
                      ‚¨áÔ∏è Descargar
                    </button>
                  </div>
                  <div class="status-indicator">
                    <span class="status-dot ready" id="statusDot"></span>
                    <span id="statusText">Listo para ejecutar</span>
                  </div>
                  <button class="toolbar-btn success" onclick="runCode()" id="runBtn">
                    ‚ñ∂ Ejecutar
                  </button>
                </div>
              </div>

              <!-- Output Section -->
              <div class="output-section">
                <div class="output-tabs">
                  <div class="output-tab active" onclick="switchTab('console')" id="consoleTab">
                    üñ•Ô∏è Consola
                  </div>
                  <div class="output-tab" onclick="switchTab('result')" id="resultTab">
                    üì§ Resultado
                  </div>
                </div>
                
                <!-- Console Output -->
                <div class="output-container" id="consoleOutput">
                  <div class="output-content" id="consoleContent">
                    <div class="output-empty">La consola est√° lista. Ejecuta el c√≥digo o selecciona un ejemplo de Buenas Pr√°cticas...</div>
                  </div>
                </div>
                
                <!-- Result Output (hidden by default) -->
                <div class="output-container" id="resultOutput" style="display: none;">
                  <div class="output-content" id="resultContent">
                    <div class="output-empty">El resultado de la ejecuci√≥n aparecer√° aqu√≠...</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </section>
    </div>
  </div>

  <script>
    // Lesson data
    const lessons = [
      { id: '1.1', title: 'Lecci√≥n 1.1: Introducci√≥n a GAS', module: 1 },
      { id: '1.2', title: 'Lecci√≥n 1.2: Variables y Funciones', module: 1 },
      { id: '2.1', title: 'Lecci√≥n 2.1: Primeros pasos con Sheets', module: 2 },
      { id: '2.2', title: 'Lecci√≥n 2.2: Manipulaci√≥n de Datos', module: 2 },
      { id: '2.3', title: 'Lecci√≥n 2.3: Dominando el IDE', module: 2 },
      { id: '3.1', title: 'Lecci√≥n 3.1: Triggers y Automatizaci√≥n', module: 3 },
      { id: '3.2', title: 'Lecci√≥n 3.2: Proyecto Final', module: 3 }
    ];

    // Example codes for Best Practices
    const exampleCodes = {
      logging: `function ejemploLogging() {
  // Logging Moderno con console.log()
  console.log("=== Inicio del proceso ===");
  
  var datos = ["Usuario1", "Usuario2", "Usuario3"];
  
  datos.forEach(function(usuario, index) {
    // Informaci√≥n general
    console.log("Procesando usuario: " + usuario);
    
    // Informaci√≥n detallada
    console.info("√çndice actual: " + index);
    
    // Advertencias
    if (index === 1) {
      console.warn("Usuario en posici√≥n cr√≠tica");
    }
  });
  
  console.log("=== Proceso completado ===");
}`,
      
      debugging: `function ejemploDebugging() {
  // Ejemplo de preparaci√≥n para debugging con breakpoints
  var sheet = SpreadsheetApp.getActiveSheet();
  var datos = sheet.getDataRange().getValues();
  
  // Punto ideal para breakpoint: inspeccionar 'datos'
  console.log("Total de filas: " + datos.length);
  
  for (var i = 1; i < datos.length; i++) {
    var fila = datos[i];
    
    // Punto para breakpoint: ver valores de cada fila
    var nombre = fila[0];
    var email = fila[1];
    var estado = fila[2];
    
    console.log("Fila " + i + ": " + nombre + " - " + estado);
    
    // Inspeccionar variables en el debugger
    if (estado === "Pendiente") {
      // Colocar breakpoint aqu√≠ para ver el flujo
      console.info("Procesando item pendiente");
    }
  }
}`,
      
      errors: `function ejemploManejoErrores() {
  var sheet = SpreadsheetApp.getActiveSheet();
  
  try {
    // Intentar obtener datos
    var datos = sheet.getDataRange().getValues();
    console.log("Datos obtenidos: " + datos.length + " filas");
    
    // Procesar datos
    for (var i = 1; i < datos.length; i++) {
      try {
        var email = datos[i][0];
        
        // Validar email antes de enviar
        if (!email || email === "") {
          throw new Error("Email vac√≠o en fila " + (i + 1));
        }
        
        // Simular env√≠o
        console.log("Enviando a: " + email);
        
      } catch (filaError) {
        // Error espec√≠fico de la fila
        console.error("Error en fila " + i + ": " + filaError.message);
        continue; // Continuar con la siguiente fila
      }
    }
    
  } catch (errorGeneral) {
    // Error general del proceso
    console.error("ERROR CR√çTICO: " + errorGeneral.message);
    console.error("Stack: " + errorGeneral.stack);
  } finally {
    // Siempre ejecutar al final
    console.log("Proceso finalizado");
  }
}`,
      
      optimization: `function ejemploOptimizacion() {
  var sheet = SpreadsheetApp.getActiveSheet();
  
  // ‚úÖ FORMA √ìPTIMA: Leer todo de una vez
  console.time("Lectura √≥ptima");
  var datos = sheet.getDataRange().getValues();
  console.timeEnd("Lectura √≥ptima");
  
  // ‚úÖ FORMA √ìPTIMA: Modificar en memoria
  var modificados = 0;
  for (var i = 1; i < datos.length; i++) {
    if (datos[i][2] === "Pendiente") {
      datos[i][2] = "Procesado"; // Modificar en memoria
      modificados++;
    }
  }
  
  // ‚úÖ FORMA √ìPTIMA: Escribir todo de una vez
  console.time("Escritura √≥ptima");
  sheet.getRange(1, 1, datos.length, datos[0].length).setValues(datos);
  console.timeEnd("Escritura √≥ptima");
  
  console.log("Filas modificadas: " + modificados);
  console.log("¬°Solo 2 llamadas a la API en total!");
}`
    };

    let currentLessonIndex = 4; // Currently on lesson 2.3
    const defaultCode = exampleCodes.optimization;

    // DOM Elements
    const codeEditor = document.getElementById('codeEditor');
    const lineNumbers = document.getElementById('lineNumbers');
    const consoleContent = document.getElementById('consoleContent');
    const resultContent = document.getElementById('resultContent');
    const statusDot = document.getElementById('statusDot');
    const statusText = document.getElementById('statusText');
    const runBtn = document.getElementById('runBtn');

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateLineNumbers();
      updateNavButtons();
    });

    // Line numbers sync
    codeEditor.addEventListener('input', updateLineNumbers);
    codeEditor.addEventListener('scroll', () => {
      lineNumbers.scrollTop = codeEditor.scrollTop;
    });

    function updateLineNumbers() {
      const lines = codeEditor.value.split('\n').length;
      lineNumbers.innerHTML = Array.from({ length: lines }, (_, i) => i + 1).join('<br>');
    }

    // Tab key support
    codeEditor.addEventListener('keydown', (e) => {
      if (e.key === 'Tab') {
        e.preventDefault();
        const start = codeEditor.selectionStart;
        const end = codeEditor.selectionEnd;
        codeEditor.value = codeEditor.value.substring(0, start) + '  ' + codeEditor.value.substring(end);
        codeEditor.selectionStart = codeEditor.selectionEnd = start + 2;
      }
    });

    // Load Example from Best Practices
    function loadExample(exampleType) {
      const code = exampleCodes[exampleType];
      if (code) {
        codeEditor.value = code;
        updateLineNumbers();
        
        // Log to console
        const exampleNames = {
          logging: 'Logging Moderno',
          debugging: 'Depuraci√≥n con Breakpoints',
          errors: 'Manejo de Errores',
          optimization: 'Optimizaci√≥n de Velocidad'
        };
        
        logToConsole('Ejemplo cargado: ' + exampleNames[exampleType], 'success');
        logToConsole('Revisa el c√≥digo y ejec√∫talo para ver el resultado', 'info');
        
        // Scroll editor to top
        codeEditor.scrollTop = 0;
      }
    }

    // Title Dropdown
    function toggleTitleDropdown() {
      const menu = document.getElementById('titleDropdownMenu');
      const btn = document.getElementById('titleDropdownBtn');
      menu.classList.toggle('open');
      btn.classList.toggle('open');
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', (e) => {
      const wrapper = document.querySelector('.title-dropdown-wrapper');
      if (!wrapper.contains(e.target)) {
        document.getElementById('titleDropdownMenu').classList.remove('open');
        document.getElementById('titleDropdownBtn').classList.remove('open');
      }
    });

    // Select Lesson
    function selectLesson(lessonId) {
      const index = lessons.findIndex(l => l.id === lessonId);
      if (index !== -1) {
        currentLessonIndex = index;
        updateLessonDisplay();
        updateNavButtons();
        toggleTitleDropdown();
      }
    }

    // Navigate with arrows
    function navigateLesson(direction) {
      const newIndex = currentLessonIndex + direction;
      if (newIndex >= 0 && newIndex < lessons.length) {
        currentLessonIndex = newIndex;
        updateLessonDisplay();
        updateNavButtons();
      }
    }

    function updateLessonDisplay() {
      const lesson = lessons[currentLessonIndex];
      document.getElementById('currentLessonTitle').textContent = lesson.title;
      
      // Update dropdown active state
      document.querySelectorAll('.dropdown-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.lesson === lesson.id) {
          item.classList.add('active');
        }
      });
    }

    function updateNavButtons() {
      document.getElementById('prevBtn').disabled = currentLessonIndex === 0;
      document.getElementById('nextBtn').disabled = currentLessonIndex === lessons.length - 1;
    }

    // Editor Functions
    function clearEditor() {
      if (confirm('¬øEst√°s seguro de que quieres borrar todo el c√≥digo?')) {
        codeEditor.value = '';
        updateLineNumbers();
        logToConsole('Editor limpiado', 'info');
      }
    }

    function restoreEditor() {
      if (confirm('¬øRestaurar el c√≥digo original?')) {
        codeEditor.value = defaultCode;
        updateLineNumbers();
        logToConsole('C√≥digo restaurado', 'info');
      }
    }

    function downloadCode() {
      const code = codeEditor.value;
      const blob = new Blob([code], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'codigo.gs';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      logToConsole('C√≥digo descargado como codigo.gs', 'success');
    }

    function copyReferenceCode() {
      navigator.clipboard.writeText(codeEditor.value).then(() => {
        logToConsole('C√≥digo copiado al portapapeles', 'success');
      });
    }

    // Run Code
    function runCode() {
      const code = codeEditor.value;
      
      // Update status
      statusDot.className = 'status-dot running';
      statusText.textContent = 'Ejecutando...';
      runBtn.disabled = true;
      runBtn.textContent = '‚è≥ Ejecutando...';
      
      // Clear outputs
      consoleContent.innerHTML = '';
      resultContent.innerHTML = '';
      
      logToConsole('Iniciando ejecuci√≥n del c√≥digo...', 'info');
      
      // Simulate execution (replace with actual GAS execution)
      setTimeout(() => {
        try {
          // Simulated execution result
          logToConsole('C√≥digo ejecutado correctamente', 'success');
          
          // Show result
          showResult(`‚úÖ Ejecuci√≥n completada exitosamente

üìä Resumen:
‚Ä¢ C√≥digo procesado sin errores
‚Ä¢ Logs generados en consola
‚Ä¢ Tiempo de ejecuci√≥n: 0.5s

üí° Nota: En un entorno real con GAS, el c√≥digo se ejecutar√≠a en los servidores de Google`);
          
          // Update status
          statusDot.className = 'status-dot ready';
          statusText.textContent = 'Listo para ejecutar';
          runBtn.disabled = false;
          runBtn.textContent = '‚ñ∂ Ejecutar';
          
        } catch (error) {
          logToConsole('Error: ' + error.message, 'error');
          statusDot.className = 'status-dot ready';
          statusText.textContent = 'Error en ejecuci√≥n';
          runBtn.disabled = false;
          runBtn.textContent = '‚ñ∂ Ejecutar';
        }
      }, 1200);
    }

    // Console logging
    function logToConsole(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const line = document.createElement('div');
      line.className = 'output-line';
      line.innerHTML = `
        <span class="output-timestamp">[${timestamp}]</span>
        <span class="output-label ${type}">${type}</span>
        <span class="output-message">${message}</span>
      `;
      consoleContent.appendChild(line);
      consoleContent.scrollTop = consoleContent.scrollHeight;
    }

    // Show result
    function showResult(result) {
      resultContent.innerHTML = `<div class="result-content">${result}</div>`;
    }

    // Tab switching
    function switchTab(tab) {
      const consoleOutput = document.getElementById('consoleOutput');
      const resultOutput = document.getElementById('resultOutput');
      const consoleTab = document.getElementById('consoleTab');
      const resultTab = document.getElementById('resultTab');
      
      if (tab === 'console') {
        consoleOutput.style.display = 'block';
        resultOutput.style.display = 'none';
        consoleTab.classList.add('active');
        resultTab.classList.remove('active');
      } else {
        consoleOutput.style.display = 'none';
        resultOutput.style.display = 'block';
        consoleTab.classList.remove('active');
        resultTab.classList.add('active');
      }
    }
  </script>
</body>
</html>
